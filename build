#!/bin/bash
# -----------------------------------------------------------------------------
set -euo pipefail # Stop running the script on first error...
# -----------------------------------------------------------------------------
source .env
pushd ./app > /dev/null

case ${CLOUD_PROVIDER:-} in
  azure)
    # Building images using the Azure Cloud
    az acr build -t ${IMAGE_ID} -r ${CLUSTER_TARGET} -f Dockerfile .
    ;;
  aws)
    # Building images using the AWS Cloud
    docker build -t ${REGISTRY}/${IMAGE_ID} .
    ;;
  google)
    # Building images using the Google Cloud
    docker build -t ${REGISTRY}/${IMAGE_ID} .
    ;;
  *)
    # Default: Build image using local docker
    docker build -t ${REGISTRY}/${IMAGE_ID} .
    ;;
esac