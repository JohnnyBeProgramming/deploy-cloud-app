#!/bin/bash
# -----------------------------------------------------------------------------
set -euo pipefail # Stop running the script on first error...
# -----------------------------------------------------------------------------
source .env

clean() {
    target=$1

    # Delete the deployed helm chart (if exists)
    if helm history -n ${NAMESPACE} ${target} > /dev/null 2>&1
    then
        helm del ${target} -n ${NAMESPACE}
    fi
}

clean "storage"
clean ${PROJECT}

# Or you can remove the deployed resources manually
# kubectl delete service ${PROJECT} --wait
# kubectl delete deployment ${PROJECT} --wait
# kubectl get service
